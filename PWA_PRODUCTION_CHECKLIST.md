# PWA Production Deployment Checklist

## ‚úÖ Files Ready for Production
These files are essential for PWA functionality and should be deployed:

### Core PWA Files
- `/public/pwa-sw.js` - Service worker with offline caching
- `/public/offline.html` - Offline fallback page
- `/public/manifest-wisdomwarehouse.json` - Static manifest for Wisdom Warehouse
- `/public/icons/wisdom-warehouse-192.png` - 192x192 PWA icon
- `/public/icons/wisdom-warehouse-512.png` - 512x512 PWA icon

### React Components
- `/src/components/ServiceWorkerRegistration.tsx` - Manual SW registration (bypasses @ducanh2912/next-pwa)
- `/src/components/ManualPWAInstall.tsx` - User-friendly install button with instructions

### Modified Files
- `/src/app/layout.tsx` - Server-side manifest link & theme color (CRITICAL!)
- `/src/components/tenancy/DynamicManifest.tsx` - Static manifest routing
- `/src/app/api/manifest/route.ts` - Added `id` field to manifest

## ‚ùå Don't Deploy to Production
These are development/debugging tools:

### HTML Diagnostic Tools (Delete or .gitignore)
- `/public/pwa-chrome-check.html`
- `/public/pwa-inspector.html`
- `/public/pwa-install-checker.html`
- `/public/pwa-reset.html`
- `/public/pwa-status-check.html`
- `/public/pwa-test-standalone.html`
- `/public/test-pwa-prompt.html`

### React Debug Pages (Delete or .gitignore)
- `/src/app/pwa-debug/page.tsx`
- `/src/app/pwa-diagnostic/page.tsx`

## üöÄ Deployment Steps

### Option 1: Delete Debug Files (Cleanest)
```powershell
Remove-Item public/pwa-chrome-check.html
Remove-Item public/pwa-inspector.html
Remove-Item public/pwa-install-checker.html
Remove-Item public/pwa-reset.html
Remove-Item public/pwa-status-check.html
Remove-Item public/pwa-test-standalone.html
Remove-Item public/test-pwa-prompt.html
Remove-Item -Recurse src/app/pwa-debug
Remove-Item -Recurse src/app/pwa-diagnostic
```

### Option 2: Add to .gitignore (Keep locally)
Add to `.gitignore`:
```
# PWA Debug Tools (local development only)
public/pwa-*-check.html
public/pwa-inspector.html
public/pwa-install-checker.html
public/pwa-reset.html
public/pwa-test-standalone.html
public/test-pwa-prompt.html
src/app/pwa-debug/
src/app/pwa-diagnostic/  
```

### Option 3: Create Debug Branch (Keep for future)
```powershell
git checkout -b pwa-debug-tools
git add public/pwa-*.html src/app/pwa-debug src/app/pwa-diagnostic
git commit -m "PWA debug and diagnostic tools"
git checkout main
# Delete from main branch
```

## ‚úÖ Production Verification Checklist

After deployment, verify:

1. **Service Worker Registration**
   - Open DevTools ‚Üí Application ‚Üí Service Workers
   - Should see `/pwa-sw.js` as "activated and is running"

2. **Manifest Loading**
   - DevTools ‚Üí Application ‚Üí Manifest
   - Wisdom Warehouse: Shows `/manifest-wisdomwarehouse.json`
   - Other tenants: Shows `/api/manifest?tenant=...`
   - Default S24: Shows `/manifest.json`

3. **Icons Display**
   - DevTools ‚Üí Application ‚Üí Manifest ‚Üí Icons section
   - Should show 4 icons with thumbnails (192x192 and 512x512, any + maskable)

4. **Theme Color**
   - Check page source: `<meta name="theme-color" content="#1e40af">` for Wisdom
   - Chrome address bar should match tenant's primary color

5. **PWA Installability**
   - After 2-3 visits with engagement, Chrome menu should show "Install ..."
   - Or install button appears (ManualPWAInstall component)

## üìä Final File Count
- **To Deploy**: 11 files (8 new + 3 modified)
- **Don't Deploy**: 9 debug files

## üîç What Changed (For Team)
- **Before**: PWA used @ducanh2912/next-pwa autogenerated manifest (dynamic API route)
- **After**: Server-rendered manifest link in HTML `<head>`, static manifest files for faster Chrome detection
- **Why**: Chrome checks for PWA criteria on initial HTML load, not after React hydrates

## üéØ Expected Behavior in Production
1. User visits `learn.wisdomwarehouseuae.com`
2. Service worker registers immediately
3. Manifest loads (static file, instant)
4. After browsing 2-3 pages and returning later:
   - Chrome menu (‚ãÆ) ‚Üí "Save and share" ‚Üí "Install Wisdom Warehouse"
   - Or `ManualPWAInstall` button appears
5. User clicks install ‚Üí PWA launches with Wisdom Warehouse branding

## üêõ If Issues After Deployment
1. Check browser console for service worker errors
2. Verify manifest URL in page source matches expected path  
3. Test in incognito (fresh session, no cached dismissals)
4. Allow 24-48 hours for Chrome's engagement heuristics to recognize repeated visits

---

**Ready to push?** Follow Option 1 above to delete debug files, then deploy! üöÄ
